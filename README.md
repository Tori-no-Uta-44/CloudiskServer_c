# CloudiskServer_c
网盘，C
## 数据库使用介绍

**数据库每一个字段的使用说明**

所有主键均有自增

user（用户表）

|              | userId                                     | userName    | userPassword | salt        | passwordLastChange                                           | fileId                                                       |
| ------------ | ------------------------------------------ | ----------- | ------------ | ----------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 数据类型     | int                                        | varchar(32) | varchar(32)  | varchar(32) | datetime                                                     | int                                                          |
| 字段作用     | 用户ID                                     | 用户名      | 用户密码     | 盐值        | 最后一次密码更改时间                                         | 当前所在的虚拟路径(pwd)                                      |
| 是否允许为空 | F                                          | F           | F            | F           | F                                                            | F                                                            |
| 默认值       |                                            |             |              |             | now()                                                        | 0                                                            |
| 备注         | 主键，与虚拟文件表关联了外键（字段名相同） |             |              |             | 获取当前时间，时间格式为：2008-11-11 12:45:34。它是mysql中的function。 | 用户注册时给0表示用户自己的根目录，可以换为自己的表示方式，比如-1，后续更新为用户每次cd时的路径id，进行LEFT JOIN。记录退出时所在的虚拟路径，以及用户在线时的当前虚拟路径 |

globalFile（全局文件）

|              | hashId                                     | hash         | linkCount | lastLinkTime            | isDel                  |
| ------------ | ------------------------------------------ | ------------ | --------- | ----------------------- | ---------------------- |
| 数据类型     | int                                        | varchar(512) | int       | date                    | set ('true', 'false')  |
| 字段作用     | 文件哈希值的ID                             | 哈希值       | 连接数    | 最后一个连接的修改时间  | 服务器文件是否删除与否 |
| 是否允许为空 | F                                          | T            | T         | T                       | T                      |
| 默认值       |                                            |              |           |                         | false                  |
| 备注         | 主键，与虚拟文件表关联了外键（字段名相同） |              |           | 用now()或者进行字符拼接 |                        |

virtualFile（虚拟文件）

|              | fileId | parentId                                                     | fileName    | userId                   | hashId                           | fileSize                 | type                        | path         |
| ------------ | ------ | ------------------------------------------------------------ | ----------- | ------------------------ | -------------------------------- | ------------------------ | --------------------------- | ------------ |
| 数据类型     | int    | int                                                          | varchar(32) | int                      | int                              | int                      | set ('Directory', 'File')   | varchar(32)  |
| 字段作用     | 文件ID | 所在上一层目录，0表示顶层目录（0可以换为自己的表示方式，比如-1） | 文件名      | 文件里属于某一个用户的ID | 文件对应的哈希在全局文件表中的ID | 文件大小（-1表示文件夹） | 文件类型                    | 完整虚拟路径 |
| 是否允许为空 | F      | F                                                            | F           | F                        |                                  | F                        | F                           | F            |
| 默认值       |        |                                                              |             |                          |                                  |                          |                             |              |
| 备注         | 主键   |                                                              |             | 与用户关联的外键         | 与全局文件表关联的外键           |                          | 值只能为：Directory或者File |              |

log（日志）

|          | log_level   | file         | line | times    | info         |
| -------- | ----------- | ------------ | ---- | -------- | ------------ |
| 数据类型 | varchar(16) | varchar(128) | int  | datetime | varchar(200) |
| 字段作用 | 日志级别    | 文件位置     | 行号 | 添加时间 | 详细信息     |

## 使用说明

1.  文件的哈希id为：
2.  文件夹的表示id为：
3.  xxxx
